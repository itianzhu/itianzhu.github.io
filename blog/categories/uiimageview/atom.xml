<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: UIImageView | tz's Blog]]></title>
  <link href="http://itianzhu.github.io/blog/categories/uiimageview/atom.xml" rel="self"/>
  <link href="http://itianzhu.github.io/"/>
  <updated>2013-12-26T23:41:49+08:00</updated>
  <id>http://itianzhu.github.io/</id>
  <author>
    <name><![CDATA[tz]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[TZAsynchImageView]]></title>
    <link href="http://itianzhu.github.io/blog/2013/12/17/tzasynchimageview/"/>
    <updated>2013-12-17T23:09:39+08:00</updated>
    <id>http://itianzhu.github.io/blog/2013/12/17/tzasynchimageview</id>
    <content type="html"><![CDATA[<p>非ARC，支持文件、内存缓存</p>

<h3>使用方法</h3>

<p>{% codeblock lang:objc %}
TZAsynchImageView *imageView = [[[TZAsynchImageView alloc] initWithUrlString:@&ldquo;url&rdquo; frame:self.view.bounds placeholder:[UIImage imageNamed:@&ldquo;p.jpg&rdquo;] autorelease];
{% endcodeblock %}
or
{% codeblock lang:objc %}
[imageView setUrlString:@&ldquo;url&rdquo;];
[imageView setUrlString:@&ldquo;url&rdquo; placeholder:[UIImage imageNamed:@&ldquo;p.jpg&rdquo;]];
{% endcodeblock %}
清除文件缓存
{% codeblock lang:objc %}
[TZAsynchDownloader clearCacheFilesBefore:[NSDate date]];
[TZAsynchDownloaderclearAllCacheFiles];
{% endcodeblock %}
清除内存缓存,每次退出一个界面的时候，可以清理一次
{% codeblock lang:objc %}
[[TZAsynchDownloader getInstance] clearMemoryFiles];
{% endcodeblock %}</p>

<h3>原理</h3>

<blockquote><ol>
<li>查找urlString是否在cache，如果不在到2，否则执行6</li>
<li>查找urlString是否在文件中，如果不在到3，否则把图片加入cache，执行6</li>
<li>注册kDownloadedImage的消息，下载单例开始下载</li>
<li>下载完成，存入cache，存入文件，发出kDownloadedImage消息</li>
<li>所有注册kDownloadedImage的imageview执行1</li>
<li>返回图片</li>
</ol>
</blockquote>

<p>项目地址:<a href="https://github.com/itianzhu/TZAsynchImageView">https://github.com/itianzhu/TZAsynchImageView</a></p>
]]></content>
  </entry>
  
</feed>
